{"remainingRequest":"/Users/maguodong/Documents/projects/luffycity/web im/node_modules/babel-loader/lib/index.js!/Users/maguodong/Documents/projects/luffycity/web im/node_modules/eslint-loader/index.js??ref--13-0!/Users/maguodong/Documents/projects/luffycity/web im/src/store/modules/user.js","dependencies":[{"path":"/Users/maguodong/Documents/projects/luffycity/web im/src/store/modules/user.js","mtime":1576188392000},{"path":"/Users/maguodong/Documents/projects/luffycity/web im/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/maguodong/Documents/projects/luffycity/web im/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/maguodong/Documents/projects/luffycity/web im/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import tim from \"../../tim\";\nvar user = {\n  state: {\n    currentUserProfile: {},\n    isLogin: false,\n    isSDKReady: false // TIM SDK 是否 ready\n\n  },\n  mutations: {\n    updateCurrentUserProfile: function updateCurrentUserProfile(state, userProfile) {\n      state.currentUserProfile = userProfile;\n    },\n    toggleIsLogin: function toggleIsLogin(state, isLogin) {\n      state.isLogin = typeof isLogin === 'undefined' ? !state.isLogin : isLogin;\n    },\n    toggleIsSDKReady: function toggleIsSDKReady(state, isSDKReady) {\n      state.isSDKReady = typeof isSDKReady === 'undefined' ? !state.isSDKReady : isSDKReady;\n    },\n    reset: function reset(state) {\n      Object.assign(state, {\n        currentUserProfile: {},\n        isLogin: false,\n        isSDKReady: false // TIM SDK 是否 ready\n\n      });\n    }\n  },\n  actions: {\n    // login(context, userID) {\n    //   tim\n    //     .login({\n    //       userID,\n    //       userSig: window.genTestUserSig(userID).userSig\n    //     })\n    //     .then(() => {\n    //       context.commit('toggleIsLogin', true)\n    //       context.commit('startComputeCurrent')\n    //       window.$message({ type: 'success', message: '登录成功' })\n    //     })\n    //     .catch(imError => {\n    //       if (imError.code === 2000) {\n    //         window.$message.error(imError.message + ', 请检查是否正确填写了 SDKAPPID')\n    //       } else {\n    //         window.$message.error(imError.message)\n    //       }\n    //     })\n    // },\n    logout: function logout(context) {\n      // 若有当前会话，在退出登录时已读上报\n      if (context.rootState.conversation.currentConversation.conversationID) {\n        tim.setMessageRead({\n          conversationID: context.rootState.conversation.currentConversation.conversationID\n        });\n      }\n\n      tim.logout().then(function () {\n        context.commit('toggleIsLogin');\n        context.commit('stopComputeCurrent');\n        context.commit('reset');\n      });\n    }\n  }\n};\nexport default user;",{"version":3,"sources":["/Users/maguodong/Documents/projects/luffycity/web im/src/store/modules/user.js"],"names":["tim","user","state","currentUserProfile","isLogin","isSDKReady","mutations","updateCurrentUserProfile","userProfile","toggleIsLogin","toggleIsSDKReady","reset","Object","assign","actions","logout","context","rootState","conversation","currentConversation","conversationID","setMessageRead","then","commit"],"mappings":"AAAA,OAAOA,GAAP;AACA,IAAMC,IAAI,GAAG;AACXC,EAAAA,KAAK,EAAE;AACLC,IAAAA,kBAAkB,EAAE,EADf;AAELC,IAAAA,OAAO,EAAE,KAFJ;AAGLC,IAAAA,UAAU,EAAE,KAHP,CAGa;;AAHb,GADI;AAMXC,EAAAA,SAAS,EAAE;AACTC,IAAAA,wBADS,oCACgBL,KADhB,EACuBM,WADvB,EACoC;AAC3CN,MAAAA,KAAK,CAACC,kBAAN,GAA2BK,WAA3B;AACD,KAHQ;AAITC,IAAAA,aAJS,yBAIKP,KAJL,EAIYE,OAJZ,EAIqB;AAC5BF,MAAAA,KAAK,CAACE,OAAN,GAAgB,OAAOA,OAAP,KAAmB,WAAnB,GAAiC,CAACF,KAAK,CAACE,OAAxC,GAAkDA,OAAlE;AACD,KANQ;AAOTM,IAAAA,gBAPS,4BAOQR,KAPR,EAOeG,UAPf,EAO2B;AAClCH,MAAAA,KAAK,CAACG,UAAN,GAAmB,OAAOA,UAAP,KAAsB,WAAtB,GAAoC,CAACH,KAAK,CAACG,UAA3C,GAAwDA,UAA3E;AACD,KATQ;AAUTM,IAAAA,KAVS,iBAUHT,KAVG,EAUI;AACXU,MAAAA,MAAM,CAACC,MAAP,CAAcX,KAAd,EAAqB;AACnBC,QAAAA,kBAAkB,EAAE,EADD;AAEnBC,QAAAA,OAAO,EAAE,KAFU;AAGnBC,QAAAA,UAAU,EAAE,KAHO,CAGD;;AAHC,OAArB;AAKD;AAhBQ,GANA;AAwBXS,EAAAA,OAAO,EAAE;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAC,IAAAA,MApBO,kBAoBAC,OApBA,EAoBS;AACd;AACA,UAAIA,OAAO,CAACC,SAAR,CAAkBC,YAAlB,CAA+BC,mBAA/B,CAAmDC,cAAvD,EAAuE;AACrEpB,QAAAA,GAAG,CAACqB,cAAJ,CAAmB;AAAED,UAAAA,cAAc,EAAEJ,OAAO,CAACC,SAAR,CAAkBC,YAAlB,CAA+BC,mBAA/B,CAAmDC;AAArE,SAAnB;AACD;;AACDpB,MAAAA,GAAG,CAACe,MAAJ,GAAaO,IAAb,CAAkB,YAAM;AACtBN,QAAAA,OAAO,CAACO,MAAR,CAAe,eAAf;AACAP,QAAAA,OAAO,CAACO,MAAR,CAAe,oBAAf;AACAP,QAAAA,OAAO,CAACO,MAAR,CAAe,OAAf;AACD,OAJD;AAKD;AA9BM;AAxBE,CAAb;AA0DA,eAAetB,IAAf","sourcesContent":["import tim from '../../tim'\nconst user = {\n  state: {\n    currentUserProfile: {},\n    isLogin: false,\n    isSDKReady: false // TIM SDK 是否 ready\n  },\n  mutations: {\n    updateCurrentUserProfile(state, userProfile) {\n      state.currentUserProfile = userProfile\n    },\n    toggleIsLogin(state, isLogin) {\n      state.isLogin = typeof isLogin === 'undefined' ? !state.isLogin : isLogin\n    },\n    toggleIsSDKReady(state, isSDKReady) {\n      state.isSDKReady = typeof isSDKReady === 'undefined' ? !state.isSDKReady : isSDKReady\n    },\n    reset(state) {\n      Object.assign(state, {\n        currentUserProfile: {},\n        isLogin: false,\n        isSDKReady: false // TIM SDK 是否 ready\n      })\n    }\n  },\n  actions: {\n    // login(context, userID) {\n    //   tim\n    //     .login({\n    //       userID,\n    //       userSig: window.genTestUserSig(userID).userSig\n    //     })\n    //     .then(() => {\n    //       context.commit('toggleIsLogin', true)\n    //       context.commit('startComputeCurrent')\n    //       window.$message({ type: 'success', message: '登录成功' })\n    //     })\n    //     .catch(imError => {\n    //       if (imError.code === 2000) {\n    //         window.$message.error(imError.message + ', 请检查是否正确填写了 SDKAPPID')\n    //       } else {\n    //         window.$message.error(imError.message)\n    //       }\n    //     })\n    // },\n    logout(context) {\n      // 若有当前会话，在退出登录时已读上报\n      if (context.rootState.conversation.currentConversation.conversationID) {\n        tim.setMessageRead({ conversationID: context.rootState.conversation.currentConversation.conversationID })\n      }\n      tim.logout().then(() => {\n        context.commit('toggleIsLogin')\n        context.commit('stopComputeCurrent')\n        context.commit('reset')\n      })\n    }\n  }\n}\n\nexport default user\n"]}]}